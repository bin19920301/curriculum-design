webpackJsonp([7],{"+S0g":function(t,e){},"8oE4":function(t,e){},sR4F:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Xxa5"),r=s.n(a),n=s("exGp"),i=s.n(n),o=s("mrNh"),c={name:"course",data:function(){return{status:0,loading:!1,id:"",items:"",craftCardInfoDTOList:[],workMessageInfoDTOList:[],itemsbm:[],itemsxs:[],talktext:"",timer:""}},mounted:function(){var t=this.$route.params.id;this.id=t,this.Getallsurface(),this.Getallprocessingmethod(),this.Getworkinfobyid()},methods:{timers:function(){var t=this;this.timer=setInterval(function(){t.savework(2)},1e4)},addafter:function(t){this.craftCardInfoDTOList.splice(t+1,0,{surfaceId:"",processingMethodId:"",processContent:"",id:"",sort:""})},delcarts:function(t){this.craftCardInfoDTOList.splice(t,1)},removefront:function(t){var e=this.craftCardInfoDTOList[t];this.craftCardInfoDTOList.splice(t,1),this.craftCardInfoDTOList.splice(t-1,0,e)},removeafter:function(t){var e=this.craftCardInfoDTOList[t];this.craftCardInfoDTOList.splice(t,1),this.craftCardInfoDTOList.splice(t+1,0,e)},viewwork:function(){this.$router.push({path:"workdetail"})},submitwork:function(){var t=this,e=!1;this.craftCardInfoDTOList.forEach(function(s,a){return s.surfaceId?s.processingMethodId?s.processContent?void 0:(t.$message({showClose:!0,message:"请为工序"+parseInt(a+1)+"填写工序内容",type:"warning"}),void(e=!0)):(t.$message({showClose:!0,message:"请为工序"+parseInt(a+1)+"选择加工形式",type:"warning"}),void(e=!0)):(t.$message({showClose:!0,message:"请为工序"+parseInt(a+1)+"选择加工表面",type:"warning"}),void(e=!0))}),e||this.$confirm("确定提交？提交完成不能修改","提示",{type:"warning"}).then(function(){t.savework(1)}).catch(function(){})},deletemessage:function(t,e){var s=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then(function(){s.Deletestudentmessage(t,e)}).catch(function(){})},Deletestudentmessage:function(t,e){var s=this;return i()(r.a.mark(function a(){var n;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return s.loading=!0,a.prev=1,a.next=4,Object(o.v)(t);case 4:0==(n=a.sent).status.code?(s.$message({showClose:!0,message:"删除成功",type:"success"}),s.workMessageInfoDTOList.splice(e,1)):s.$message.error(n.status.description),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),console.log(a.t0);case 11:return a.prev=11,s.loading=!1,a.finish(11);case 14:case"end":return a.stop()}},a,s,[[1,8,11,14]])}))()},Submits:function(){var t=this;return i()(r.a.mark(function e(){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,Object(o._4)(t.id);case 4:0==(s=e.sent).status.code?(t.$message({showClose:!0,message:"作业提交成功",type:"success"}),t.Getworkinfobyid()):t.$message.error(s.status.description),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:return e.prev=11,t.loading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,t,[[1,8,11,14]])}))()},savework:function(t){var e=this;return i()(r.a.mark(function s(){var a,n;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a=e.craftCardInfoDTOList.map(function(t,e){return{craftCardId:t.id,surfaceId:t.surfaceId,processingMethodId:t.processingMethodId,processContent:t.processContent,sort:e}}),e.loading=!0,s.prev=2,s.next=5,Object(o.d)(e.id,a);case 5:0==(n=s.sent).status.code?1==t?e.Submits():0==t&&e.$message({showClose:!0,message:"作业保存成功",type:"success"}):e.$message.error(n.status.description),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),console.log(s.t0);case 12:return s.prev=12,e.loading=!1,s.finish(12);case 15:case"end":return s.stop()}},s,e,[[2,9,12,15]])}))()},Getworkinfobyid:function(){var t=this;return i()(r.a.mark(function e(){var s,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,s=t.id,e.prev=2,e.next=5,Object(o.K)(s);case 5:0==(a=e.sent).status.code?(t.items=a.result,t.workMessageInfoDTOList=a.result.workMessageInfoDTOList,t.status=a.result.status,0!=a.result.status&&2!=a.result.status||t.timers(),0==a.result.craftCardInfoDTOList.length?t.craftCardInfoDTOList=[{surfaceId:"",processingMethodId:"",processContent:"",id:"",sort:""}]:t.craftCardInfoDTOList=t.$sortBykey(a.result.craftCardInfoDTOList,"sort")):t.$message.error(a.status.description),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.prev=12,t.loading=!1,e.finish(12);case 15:case"end":return e.stop()}},e,t,[[2,9,12,15]])}))()},Addmessagebystudent:function(){var t=this;return i()(r.a.mark(function e(){var s,a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.id,a=t.talktext){e.next=4;break}return t.$message({showClose:!0,message:"讨论内容不能为空",type:"error"}),e.abrupt("return");case 4:return t.loading=!0,e.prev=6,e.next=9,Object(o.g)(s,a);case 9:0==(n=e.sent).status.code?(t.$message({showClose:!0,message:"发表成功",type:"success"}),t.talktext="",t.Getworkinfobyid()):t.$message.error(n.status.description),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:return e.prev=16,t.loading=!1,e.finish(16);case 19:case"end":return e.stop()}},e,t,[[6,13,16,19]])}))()},Getallsurface:function(){var t=this;return i()(r.a.mark(function e(){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(o.G)();case 3:0==(s=e.sent).status.code?t.itemsbm=s.result:t.$message.error(s.status.description),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:return e.prev=10,e.finish(10);case 12:case"end":return e.stop()}},e,t,[[0,7,10,12]])}))()},Getallprocessingmethod:function(){var t=this;return i()(r.a.mark(function e(){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(o.F)();case 3:0==(s=e.sent).status.code?t.itemsxs=s.result:t.$message.error(s.status.description),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:return e.prev=10,e.finish(10);case 12:case"end":return e.stop()}},e,t,[[0,7,10,12]])}))()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tstuwork"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-c-scale-to-original"}),t._v(" 课程设计\n            ")]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.items.teaching.name))])],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"container"},[a("div",{staticClass:"form"},[a("h3",[t._v(t._s(t.items.teaching.name))]),t._v(" "),a("el-form",{ref:"form",attrs:{"label-width":"90px"}},[a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"指导老师："}},[t._v("\n                    "+t._s(t.items.teaching.teacherName)+"\n                ")]),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"学生："}},[t._v("\n                    "+t._s(t.items.studentName)+"\n                ")]),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"作业项目："}},[t._v("\n                    "+t._s(t.items.workProjectInfoDTO.name)+"\n                ")]),t._v(" "),a("el-form-item",{attrs:{label:"项目简介："}},[a("div",{staticClass:"teacherishi"},[t._v(t._s(t.items.workProjectInfoDTO.desc))])]),t._v(" "),a("el-form-item",{attrs:{label:"相关资料："}},[t._l(t.items.workProjectInfoDTO.filelist,function(e){return[a("a",{staticClass:"download-bg",attrs:{href:""}},[a("el-button",{staticClass:"download",attrs:{type:"text"}},[t._v(t._s(e.name))]),t._v(" "),a("i",{staticClass:"el-icon-download"})],1),a("br")]})],2),t._v(" "),a("el-form-item",{attrs:{label:"工艺卡片："}},[t._l(t.craftCardInfoDTOList,function(e){return 1==t.status||3==t.status?a("el-form",{ref:"form",refInFor:!0,staticClass:"form-in",attrs:{"label-width":"85px"}},[a("h4",[t._v("工序"+t._s(e.sort+1))]),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"加工表面："}},[t._v("\n                          "+t._s(e.surfaceName)+"\n                      ")]),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"加工形式："}},[t._v("\n                          "+t._s(e.processingMethodName)+"\n                      ")]),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"工序内容："}},[a("div",{staticClass:"teacherishi"},[t._v(t._s(e.processContent))])])],1):t._e()}),t._v(" "),t._l(t.craftCardInfoDTOList,function(e,s){return 0==t.status||2==t.status?a("el-form",{ref:"form",refInFor:!0,staticClass:"form-in",attrs:{"label-width":"85px"}},[a("h4",[t._v("工序"+t._s(s+1)+"   "),a("el-button",{staticClass:"del-button",attrs:{disabled:t.craftCardInfoDTOList.length<2,size:"mini",type:"danger",plain:""},on:{click:function(e){return t.delcarts(s)}}},[t._v("删除卡片")])],1),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"加工表面："}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择加工表面"},model:{value:e.surfaceId,callback:function(s){t.$set(e,"surfaceId",s)},expression:"item.surfaceId"}},t._l(t.itemsbm,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{staticClass:"work-date",attrs:{size:"small",label:"加工形式："}},[a("el-select",{attrs:{size:"mini",placeholder:"请选择加工形式"},model:{value:e.processingMethodId,callback:function(s){t.$set(e,"processingMethodId",s)},expression:"item.processingMethodId"}},t._l(t.itemsxs,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{staticClass:"work-date work-date-cont",attrs:{size:"small",label:"工序内容："}},[a("div",{staticClass:"modify-bg"},[a("div",{staticClass:"modify-top"},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"300",autosize:{minRows:3},"show-word-limit":""},model:{value:e.processContent,callback:function(s){t.$set(e,"processContent",s)},expression:"item.processContent"}})],1),t._v(" "),a("div",{staticClass:"modify"},[a("p",[a("el-button",{attrs:{type:"primary",disabled:0==s,size:"mini",plain:""},on:{click:function(e){return t.removefront(s)}}},[t._v(" 向前移动 ")])],1),t._v(" "),a("p",[a("el-button",{attrs:{disabled:s+1==t.craftCardInfoDTOList.length,type:"primary",size:"mini",plain:""},on:{click:function(e){return t.removeafter(s)}}},[t._v(" 向后移动 ")])],1),t._v(" "),a("p",[a("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(e){return t.addafter(s)}}},[t._v(" 后方插入 ")])],1)])])])],1):t._e()})],2),t._v(" "),a("el-form-item",{attrs:{label:"作业讨论："}},[t._l(t.workMessageInfoDTOList,function(e,r){return a("div",{staticClass:"talk-bg"},[a("div",{staticClass:"talk"},[a("div",{staticClass:"fl pic"},[1==e.senderType?a("img",{attrs:{src:s("/qp7"),alt:""}}):t._e(),t._v(" "),a("img",{attrs:{"v:else":"",src:s("h4W/"),alt:""}})]),t._v(" "),a("p",{staticClass:"fl"},[t._v(t._s(e.senderName)+"   "+t._s(e.createtime))])]),t._v(" "),a("p",{class:[1==e.senderType?"text self green":"text self"]},[t._v(t._s(e.content)),1==e.senderType?a("i",{staticClass:"el-icon-close deldiscuss",on:{click:function(s){return t.deletemessage(e.id,r)}}}):t._e()])])}),t._v(" "),a("el-input",{staticClass:"push-talk",attrs:{type:"textarea",placeholder:"请输入内容",size:"small",rows:"4",maxlength:"300","show-word-limit":""},model:{value:t.talktext,callback:function(e){t.talktext=e},expression:"talktext"}}),t._v(" "),a("p",{staticClass:"push-button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.Addmessagebystudent}},[t._v("发表")])],1)],2)],1)],1)]),t._v(" "),a("div",{staticClass:"savebg"},[a("div",{staticClass:"savein"},[0==t.status||2==t.status?[a("p",{staticClass:"fl"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.savework(0)}}},[t._v("保存")]),t._v(" 正在自动保存...")],1),t._v(" "),a("p",{staticClass:"fr"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitwork}},[t._v("保存并提交")]),t._v(" 请于"+t._s(t.items.teaching.deadlineTime)+" 之前提交作业")],1)]:t._e(),t._v(" "),1==t.status?[a("p",{staticClass:"fr"},[a("el-alert",{attrs:{title:"作业已提交",closable:!1,effect:"dark",type:"success"}})],1)]:t._e(),t._v(" "),3==t.status?[a("p",{staticClass:"fr"},[a("el-alert",{attrs:{title:"作业已完成",closable:!1,effect:"dark",type:"success"}})],1)]:t._e()],2)])])},staticRenderFns:[]};var u=s("VU/8")(c,l,!1,function(t){s("8oE4"),s("+S0g")},"data-v-f467f35e",null);e.default=u.exports}});
//# sourceMappingURL=7.a91aba76e94bc3afa4fa.js.map